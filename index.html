<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://cdnjs.cloudflare.com https://cdn.quilljs.com https://unpkg.com; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.quilljs.com https://unpkg.com; style-src 'self' 'unsafe-inline' https://cdn.quilljs.com;">
    <title>Markdown Editor</title>
    <link rel="stylesheet" href="node_modules/highlight.js/styles/github.css">
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    <style>
        /* General Styles */
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f8f9fa;
    color: #212529;
    overflow: hidden; /* Prevent scrollbars on the body */
}

.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

/* Header */
.header {
    background-color: #ffffff;
    padding: 10px 20px;
    border-bottom: 1px solid #dee2e6;
    display: flex;
    align-items: center;
    justify-content: space-between;
    -webkit-app-region: drag; /* Draggable header */
}

.header-title {
    font-size: 1.1em;
    font-weight: 600;
}

.file-info {
    font-size: 0.9em;
    color: #6c757d;
}

/* Main Content */
.main-content {
    flex-grow: 1;
    display: flex;
    overflow: hidden; /* Important for splitter */
}

/* Split Container */
.split-container {
    display: flex;
    width: 100%;
    height: 100%;
}

.editor-panel, .preview-panel {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Prevent internal scrollbars */
}

.editor-panel {
    flex: 0 0 50%;
    display: none; /* Hidden by default */
}

.preview-panel {
    flex: 1; /* Take full width when markdown panel is hidden */
    border-left: 1px solid #dee2e6;
}

/* When markdown panel is visible */
.editor-panel.visible {
    display: flex;
    flex: 0 0 50%;
}

.preview-panel.split {
    flex: 0 0 50%;
}

/* Splitter */
.splitter {
    flex: 0 0 4px;
    background-color: #dee2e6;
    cursor: col-resize;
    transition: background-color 0.2s;
    display: none; /* Hidden by default */
}

.splitter:hover {
    background-color: #007bff;
}

/* Toolbar */
.editor-toolbar, .preview-toolbar {
    background-color: #f1f3f5;
    padding: 8px 12px;
    border-bottom: 1px solid #dee2e6;
    display: flex;
    align-items: center;
}

.editor-label, .preview-label {
    font-weight: 600;
    font-size: 0.9em;
    color: #495057;
}

.toolbar-separator {
    width: 1px;
    height: 20px;
    background-color: #ced4da;
    margin: 0 10px;
}

/* Editor & Preview */
.markdown-editor, .markdown-content {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    font-size: 16px;
    line-height: 1.6;
}

.markdown-editor {
    border: none;
    resize: none;
    background-color: #ffffff;
    color: #212529;
    font-family: "Courier New", Courier, monospace;
}

.markdown-editor:focus {
    outline: none;
}

.markdown-content {
    background-color: #ffffff;
}

/* Footer */
.footer {
    background-color: #f1f3f5;
    padding: 8px 20px;
    border-top: 1px solid #dee2e6;
    font-size: 0.85em;
    color: #6c757d;
}

.footer-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Buttons */
.btn {
    background-color: transparent;
    border: 1px solid transparent;
    padding: 5px 8px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s;
    font-size: 1em;
}

.btn:hover {
    background-color: #e9ecef;
}

.btn-icon {
    font-size: 1.2em;
}

/* Loading Overlay */
.loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.loading-spinner .spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #007bff;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
}

.loading-spinner p {
    margin-top: 10px;
    font-size: 1em;
    color: #495057;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* WYSIWYG Editor Styling */
.wysiwyg-editor {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.wysiwyg-editor .ql-container {
    flex: 1;
    border: none !important;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

.wysiwyg-editor .ql-editor {
    padding: 20px;
    line-height: 1.6;
    color: #212529;
}

.wysiwyg-editor .ql-toolbar {
    border: none !important;
    border-bottom: 1px solid #dee2e6 !important;
    padding: 8px 12px;
}

/* Markdown Content Styling (kept for compatibility) */
.markdown-content h1, .markdown-content h2, .markdown-content h3 {
    border-bottom: 1px solid #dee2e6;
    padding-bottom: 0.3em;
    margin-top: 24px;
    margin-bottom: 16px;
}

.markdown-content h1 { font-size: 2em; }
.markdown-content h2 { font-size: 1.5em; }
.markdown-content h3 { font-size: 1.2em; }

.markdown-content p {
    margin-bottom: 16px;
}

.markdown-content a {
    color: #007bff;
    text-decoration: none;
}

.markdown-content a:hover {
    text-decoration: underline;
}

.markdown-content code {
    font-family: "Courier New", Courier, monospace;
    background-color: #e9ecef;
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-size: 85%;
}

.markdown-content pre {
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    padding: 16px;
    overflow-x: auto;
}

.markdown-content pre code {
    background-color: transparent;
    padding: 0;
    border-radius: 0;
    font-size: 100%;
}

.markdown-content blockquote {
    border-left: 4px solid #ced4da;
    padding-left: 16px;
    color: #6c757d;
    margin-left: 0;
}

.markdown-content ul, .markdown-content ol {
    padding-left: 2em;
}

.markdown-content table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 16px;
}

.markdown-content th, .markdown-content td {
    border: 1px solid #dee2e6;
    padding: 8px 12px;
}

.markdown-content th {
    background-color: #f1f3f5;
    font-weight: 600;
}

.markdown-content img {
    max-width: 100%;
    height: auto;
}

    </style>
</head>
<body>
    <div class="app-container">


        <!-- Main Content -->
        <main class="main-content">
            <!-- Split View Container -->
            <div id="split-container" class="split-container">
                <!-- Left Panel - Editor -->
                <div id="editor-panel" class="editor-panel">
                    <div class="editor-toolbar">
                        <button id="new-file-btn" class="btn btn-secondary" title="New File (Ctrl+N)">
                            <span class="btn-icon">üìÑ</span>
                        </button>
                        <button id="open-file-btn" class="btn btn-secondary" title="Open File (Ctrl+O)">
                            <span class="btn-icon">üìÅ</span>
                        </button>
                        <button id="save-file-btn" class="btn btn-secondary" title="Save File (Ctrl+S)">
                            <span class="btn-icon">üíæ</span>
                        </button>
                        <button id="save-as-btn" class="btn btn-secondary" title="Save As (Ctrl+Shift+S)">
                            <span class="btn-icon">üíæ+</span>
                        </button>
                        <div class="toolbar-separator"></div>
                        <span class="editor-label">Editor</span>
                    </div>
                    <textarea id="markdown-editor" class="markdown-editor" placeholder="Start typing your markdown here...

# Welcome to Markdown Editor

This is a **live preview** markdown editor. Type in this panel and see the rendered output on the right.

## Features
- Live preview
- Syntax highlighting
- File operations (New, Open, Save, Save As)
- Resizable panels"></textarea>
                </div>

                <!-- Splitter -->
                <div id="splitter" class="splitter"></div>

                <!-- Right Panel - Preview -->
                <div id="preview-panel" class="preview-panel">
                    <div class="preview-toolbar">
                        <span class="preview-label">WYSIWYG Editor</span>
                        <div class="toolbar-separator"></div>
                        <button id="toggle-markdown" class="btn btn-secondary" title="Toggle Markdown Panel">
                            <span class="btn-icon">üìù</span>
                        </button>
                        <button id="sync-to-wysiwyg" class="btn btn-secondary" title="Sync from Markdown" style="display: none;">
                            <span class="btn-icon">‚¨ÖÔ∏è</span>
                        </button>
                        <button id="sync-to-markdown" class="btn btn-secondary" title="Sync to Markdown" style="display: none;">
                            <span class="btn-icon">‚û°Ô∏è</span>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button id="zoom-out-btn" class="btn btn-secondary" title="Zoom Out">
                            <span class="btn-icon">üîç-</span>
                        </button>
                        <button id="zoom-reset-btn" class="btn btn-secondary" title="Reset Zoom">
                            <span class="btn-icon">üîç</span>
                        </button>
                        <button id="zoom-in-btn" class="btn btn-secondary" title="Zoom In">
                            <span class="btn-icon">üîç+</span>
                        </button>
                    </div>
                    <div id="wysiwyg-editor" class="wysiwyg-editor">
                        <!-- Quill WYSIWYG editor will be initialized here -->
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <span class="footer-text">Ready</span>
                <span id="word-count" class="word-count"></span>
            </div>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading markdown file...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="node_modules/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
    <script src="https://unpkg.com/turndown/dist/turndown.js"></script>
    <script>
        // Debug output
        console.log('hljs loaded:', typeof hljs !== 'undefined');
        console.log('marked loaded:', typeof marked !== 'undefined');
        console.log('Quill loaded:', typeof Quill !== 'undefined');
        console.log('TurndownService loaded:', typeof TurndownService !== 'undefined');
    </script>
    <script src="renderer.js"></script>
</body>
</html>